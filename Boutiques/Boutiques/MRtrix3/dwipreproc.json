{
	"tool-version": "1.0.0",
	"name": "dwipreproc",
	"author": "TONIC",
	"description": "MRtrix 3.0_RC3-135-g2b8e7d0c\tdwipreproc\t bin version: 3.0_RC3-135-g2b8e7d0c\ndwipreproc: Script using the MRtrix3 Python library\n\nSYNOPSIS\n\n     Perform diffusion image pre-processing using FSL's eddy tool; including\n     inhomogeneity distortion correction using FSL's topup tool if possible\n\nUSAGE\n\n     dwipreproc [ options ] input output\n\n        input        The input DWI series to be corrected\n\n        output       The output corrected image series\n\nDESCRIPTION\n\n     Note that this script does not perform any explicit registration between\n     images provided to topup via the -se_epi option, and the DWI volumes\n     provided to eddy. In some instances (motion between acquisitions) this can\n     result in erroneous application of the inhomogeneity field during\n     distortion correction. If this could potentially be a problem for your\n     data, a possible solution is to insert the first b=0 DWI volume to be the\n     first volume of the image file provided via the -se_epi option. This will\n     hopefully be addressed within the script itself in a future update.\n\nOptions for specifying the acquisition phase-encoding design; note that one of the -rpe_* options MUST be provided\n\n  -rpe_none\n     Specify that no reversed phase-encoding image data is being provided; eddy\n     will perform eddy current and motion correction only\n\n  -rpe_pair\n     Specify that a set of images (typically b=0 volumes) will be provided for\n     use in inhomogeneity field estimation only (using the -se_epi option). It\n     is assumed that the FIRST volume(s) of this image has the SAME phase-\n     encoding direction as the input DWIs, and the LAST volume(s) has precisely\n     the OPPOSITE phase encoding\n\n  -rpe_all\n     Specify that ALL DWIs have been acquired with opposing phase-encoding; this\n     information will be used to perform a recombination of image volumes (each\n     pair of volumes with the same b-vector but different phase encoding\n     directions will be combined together into a single volume). It is assumed\n     that the SECOND HALF of the volumes in the input DWIs have corresponding\n     diffusion sensitisation directions to the FIRST HALF, but were acquired\n     using precisely the opposite phase-encoding direction\n\n  -rpe_header\n     Specify that the phase-encoding information can be found in the image\n     header(s), and that this is the information that the script should use\n\nOther options for the dwipreproc script\n\n  -pe_dir PE\n     Manually specify the phase encoding direction of the input series; can be a\n     signed axis number (e.g. -0, 1, +2), an axis designator (e.g. RL, PA, IS),\n     or NIfTI axis codes (e.g. i-, j, k)\n\n  -readout_time time\n     Manually specify the total readout time of the input series (in seconds)\n\n  -se_epi image\n     Provide an additional image series consisting of spin-echo EPI images,\n     which is to be used exclusively by topup for estimating the inhomogeneity\n     field (i.e. it will not form part of the output image series)\n\n  -align_seepi\n     Achieve alignment between the SE-EPI images used for inhomogeneity field\n     estimation, and the DWIs, by inserting the first DWI b=0 volume to the SE-\n     EPI series. Only use this option if the input SE-EPI images have identical\n     image contrast to the b=0 images present in the DWI series.\n\n  -json_import file\n     Import image header information from an associated JSON file (may be\n     necessary to determine phase encoding information)\n\n  -topup_options TopupOptions\n     Manually provide additional command-line options to the topup command\n     (provide a string within quotation marks that contains at least one space,\n     even if only passing a single command-line option to topup)\n\n  -eddy_options EddyOptions\n     Manually provide additional command-line options to the eddy command\n     (provide a string within quotation marks that contains at least one space,\n     even if only passing a single command-line option to eddy)\n\n  -eddyqc_text directory\n     Copy the various text-based statistical outputs generated by eddy into an\n     output directory\n\n  -eddyqc_all directory\n     Copy ALL outputs generated by eddy (including images) into an output\n     directory\n\nOptions for importing the diffusion gradient table\n\n  -grad GRAD\n     Provide a gradient table in MRtrix format\n\n  -fslgrad bvecs bvals\n     Provide a gradient table in FSL bvecs\/bvals format\n\nOptions for exporting the diffusion gradient table\n\n  -export_grad_mrtrix grad\n     Export the final gradient table in MRtrix format\n\n  -export_grad_fsl bvecs bvals\n     Export the final gradient table in FSL bvecs\/bvals format\n\nStandard options\n\n  -continue <TempDir> <LastFile>\n     Continue the script from a previous execution; must provide the temporary\n     directory path, and the name of the last successfully-generated file\n\n  -force\n     Force overwrite of output files if pre-existing\n\n  -help\n     Display help information for the script\n\n  -nocleanup\n     Do not delete temporary files during script, or temporary directory at\n     script completion\n\n  -nthreads number\n     Use this number of threads in MRtrix multi-threaded applications (0\n     disables multi-threading)\n\n  -tempdir \/path\/to\/tmp\/\n     Manually specify the path in which to generate the temporary directory\n\n  -quiet\n     Suppress all console output during script execution\n\n  -info\n     Display additional information and progress for every command invoked\n\n  -debug\n     Display additional debugging information over and above the output of -info\n\nAUTHOR\n     Robert E. Smith (robert.smith@florey.edu.au)\n\nCOPYRIGHT\n     Copyright (c) 2008-2018 the MRtrix3 contributors.  This Source Code Form is\n     subject to the terms of the Mozilla Public License, v. 2.0. If a copy of\n     the MPL was not distributed with this file, you can obtain one at\n     http:\/\/mozilla.org\/MPL\/2.0\/  MRtrix3 is distributed in the hope that it\n     will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty\n     of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  For more details,\n     see http:\/\/www.mrtrix.org\/\n\nREFERENCES\n\n     Andersson, J. L. & Sotiropoulos, S. N. An integrated approach to correction\n     for off-resonance effects and subject movement in diffusion MR imaging.\n     NeuroImage, 2015, 125, 1063-1078\n\n     Smith, S. M.; Jenkinson, M.; Woolrich, M. W.; Beckmann, C. F.; Behrens, T.\n     E.; Johansen-Berg, H.; Bannister, P. R.; De Luca, M.; Drobnjak, I.;\n     Flitney, D. E.; Niazy, R. K.; Saunders, J.; Vickers, J.; Zhang, Y.; De\n     Stefano, N.; Brady, J. M. & Matthews, P. M. Advances in functional and\n     structural MR image analysis and implementation as FSL. NeuroImage, 2004,\n     23, S208-S219\n\n     * If performing recombination of diffusion-weighted volume pairs with\n     opposing phase encoding directions:\n     Skare, S. & Bammer, R. Jacobian weighting of distortion corrected EPI data.\n     Proceedings of the International Society for Magnetic Resonance in\n     Medicine, 2010, 5063\n\n     * If performing EPI susceptibility distortion correction:\n     Andersson, J. L.; Skare, S. & Ashburner, J. How to correct susceptibility\n     distortions in spin-echo echo-planar images: application to diffusion\n     tensor imaging. NeuroImage, 2003, 20, 870-888\n\n     * If including \"--repol\" in -eddy_options input:\n     Andersson, J. L. R.; Graham, M. S.; Zsoldos, E. & Sotiropoulos, S. N.\n     Incorporating outlier detection and replacement into a non-parametric\n     framework for movement and distortion correction of diffusion MR images.\n     NeuroImage, 2016, 141, 556-572\n\n     * If including \"--mporder\" in -eddy_options input:\n     Andersson, J. L. R.; Graham, M. S.; Drobnjak, I.; Zhang, H.; Filippini, N.\n     & Bastiani, M. Towards a comprehensive framework for movement and\n     distortion correction of diffusion MR images: Within volume movement.\n     NeuroImage, 2017, 152, 450-466\n\n\n",
	"schema-version": "0.5",
	"container-image": {
		"image": "bids\/mrtrix3_connectome",
		"type": "docker"
	},
	"inputs": [
		{
			"description": "DWI image: 4D volume",
			"value-key": "[DWI_IMAGE]",
			"type": "File",
			"optional": false,
			"id": "dwi_image",
			"name": "DWI image"
		},
		{
			"description": "Opposite phase-encoding image: one 4D image with two b=0 volumes. FIRST volume of this image has the SAME phase-encoding direction as the input DWI. Used for distortion correction.",
			"value-key": "[OPPOSITE_PHASE-ENCODING_IMAGE]",
			"type": "File",
			"optional": false,
			"id": "opposite_phase-encoding_image",
			"name": "Opposite phase-encoding image"
		},
		{
			"description": "bvec file",
			"value-key": "[BVEC_FILE]",
			"type": "File",
			"optional": false,
			"id": "bvec_file",
			"name": "bvec file"
		},
		{
			"description": "bval file",
			"value-key": "[BVAL_FILE]",
			"type": "File",
			"optional": false,
			"id": "bval_file",
			"name": "bval file"
		},
		{
			"description": "Phase encoding direction of the DWI image",
			"default-value": "AP",
			"value-key": "[PHASE_ENCODING_DIRECTION_OF_THE_DWI_IMAGE]",
			"type": "String",
			"optional": false,
			"id": "phase_encoding_direction_of_the_dwi_image",
			"name": "Phase encoding direction of the DWI image"
		}
	],
	"output-files": [
		{
			"description": "Preprocessed DWI image: 4D volume",
			"value-key": "[PREPROCESSED_DWI_IMAGE]",
			"path-template": ".\/",
			"optional": false,
			"id": "preprocessed_dwi_image",
			"name": "Preprocessed DWI image"
		}
	],
	"command-line": "dwipreproc -rpe_pair -se_epi [OPPOSITE_PHASE-ENCODING_IMAGE] -fslgrad [BVEC_FILE] [BVAL_FILE] -pe_dir [PHASE_ENCODING_DIRECTION_OF_THE_DWI_IMAGE] -eddy_options \"--data_is_shelled \" [DWI_IMAGE] [PREPROCESSED_DWI_IMAGE]"
}
